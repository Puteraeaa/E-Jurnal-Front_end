"use strict";(self.webpackChunke_jurnal=self.webpackChunke_jurnal||[]).push([[378],{8718:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Y});var n=a(7565),s=a(3292),l=a(4963),r=a(2049),i=a(8666),d=a(5944),o=a.n(d),c=a(5689),m=a(8758),u=a(7929);const h=c.CALENDAR_EVENT_STYLE;const b=function(e){let{calendarEvents:t,addNewEvent:a,openDayDetail:s,onDateClick:l,onEventClick:d}=e;const c=o()().startOf("day"),b=["","col-start-2","col-start-3","col-start-4","col-start-5","col-start-6","col-start-7"],[f,y]=(0,n.useState)(o()().startOf("month")),[x,p]=(0,n.useState)([]),[j,g]=(0,n.useState)((()=>o()(c).format("MMM-yyyy")));(0,n.useEffect)((()=>{p(t)}),[t]);const v=e=>{let t=x.filter((t=>o()(e).isSame(o()(t.start),"day")));if(t.length>2){let e=t.length;t=t.slice(0,2),t.push({title:e-2+" more",theme:"MORE"})}return t},M=e=>o()(e).month()!==o()(f).month();return(0,u.jsx)(u.Fragment,{children:(0,u.jsxs)("div",{className:"w-[150%] md:w-full bg-base-100 p-4 rounded-lg",children:[(0,u.jsxs)("div",{className:"flex items-center justify-between",children:[(0,u.jsxs)("div",{className:"flex justify-normal gap-2 sm:gap-4",children:[(0,u.jsx)("p",{className:"font-semibold text-xl w-48",children:o()(f).format("MMMM yyyy")}),(0,u.jsx)("button",{className:"btn btn-square btn-sm btn-ghost md:ml-[-30px]",onClick:()=>{const e=o()(f).add(-1,"M").startOf("month");y(e),g(o()(e).format("MMM-yyyy"))},children:(0,u.jsx)(r.A,{className:"w-5 h-5"})}),(0,u.jsx)("button",{className:"btn btn-sm btn-ghost normal-case",onClick:()=>{const e=o()().startOf("month");y(e),g(o()(e).format("MMM-yyyy"))},children:"Bulan Ini"}),(0,u.jsx)("button",{className:"btn btn-square btn-sm btn-ghost",onClick:()=>{const e=o()(f).add(1,"M").startOf("month");y(e),g(o()(e).format("MMM-yyyy"))},children:(0,u.jsx)(i.A,{className:"w-5 h-5"})})]}),(0,u.jsx)("div",{children:(0,m.A)(["siswa.delete","guru.index","orang-tua.index"])&&(0,u.jsx)("button",{className:"btn btn-sm w-15 btn-ghost btn-outline normal-case text-xs",onClick:a,children:"Tambah Jadwal"})})]}),(0,u.jsx)("div",{className:"my-4 divider"}),(0,u.jsx)("div",{className:"grid grid-cols-7 gap-6 sm:gap-12 place-items-center",children:["sun","mon","tue","wed","thu","fri","sat"].map(((e,t)=>(0,u.jsx)("div",{className:"text-xs capitalize",children:e},t)))}),(0,u.jsx)("div",{className:"grid grid-cols-7 mt-1 place-items-center",children:(()=>{let e=o()(f).startOf("week"),t=o()(o()(f).endOf("month")).endOf("week"),a=[],n=e;for(;n<=t;)a.push(n.toDate()),n=n.clone().add(1,"d");return a})().map(((e,t)=>{return(0,u.jsxs)("div",{className:b[o()(e).day()]+" border border-solid w-full h-28",children:[(0,u.jsx)("p",{className:`inline-block flex items-center justify-center h-10 w-8 md:h-10 md:w-10 rounded-full mx-1 mt-1 text-sm cursor-pointer hover:bg-base-300 ${a=e,o()(a).isSame(o()(),"day")&&"bg-blue-100 dark:bg-blue-400 dark:hover:bg-base-300 dark:text-white"} ${M(e)&&"text-slate-400 dark:text-slate-600"}`,onClick:()=>l(e),children:o()(e).format("D")}),v(e).map(((t,a)=>(0,u.jsx)("p",{onClick:()=>"MORE"===t.theme?((e,t)=>{if("MORE"!==t)return;let a=x.filter((t=>o()(e).isSame(o()(t.start),"day")));s({filteredEvents:a,title:o()(e).format("D MMM YYYY")}),l({filteredEvents:a,title:o()(e).format("D MMM YYYY")})})(e,t.theme):void d(t),className:`text-xs px-2 mt-1 truncate ${h[t.theme]||""}`,children:t.title},a)))]},t);var a}))})]})})};var f=a(1495),y=a(9571),x=a(7850),p=(a(6804),a(3162)),j=a(1774),g=a.n(j),v=a(6709),M=a(896),N=a(8010),E=a.n(N);const k=[];const w=function(){const e=(0,s.wA)(),[t,a]=(0,n.useState)(k),[l,r]=(0,n.useState)(null),[i,d]=(0,n.useState)(null),[c,m]=(0,n.useState)([]),h=M.A.get("token"),j=JSON.parse(M.A.get("user")),N=c.map((e=>({value:e.id,label:e.name})));(0,n.useEffect)((()=>{(async()=>{try{const e=(await v.A.get("/admin/jadwal",{headers:{Authorization:`Bearer ${h}`}})).data.data,t=Object.keys(e).flatMap((t=>{const a=E()(t).tz("Asia/Jakarta");return e[t].map((e=>{const t=a.startOf("day").format("YYYY-MM-DD"),n=a.endOf("day").format("YYYY-MM-DD");return{title:`${e.status} PKL ke ${e.industri_name}`,start:t,end:n,company:e.user_name,theme:"kunjungan"===e.status?"BLUE":"GREEN",industri_name:e.industri_name}}))}));a(t)}catch(e){}})(),(async()=>{try{const e=await v.A.get("admin/industri",{headers:{Authorization:`Bearer ${h}`}});m(e.data.data.data)}catch(e){}})()}),[]);const w=t=>{let{filteredEvents:a,title:n}=t;e((0,f.cV)({header:n,bodyType:y.RIGHT_DRAWER_TYPES.CALENDAR_EVENTS,extraObject:{filteredEvents:a}}))};return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(b,{calendarEvents:t,addNewEvent:()=>{const e=document.getElementById("my_modal_1");e&&e.showModal()},openDayDetail:w,onDateClick:e=>{const a=t.filter((t=>o()(e).isSame(o()(t.start),"day"))),n=o()(e).format("D MMM YYYY");w({filteredEvents:a,title:n})}}),(0,u.jsx)("dialog",{id:"my_modal_1",className:"modal",children:(0,u.jsxs)("div",{className:"modal-box",children:[(0,u.jsx)("h3",{className:"font-bold text-lg",children:"Tambah Jadwal"}),(0,u.jsxs)("form",{id:"eventForm",className:"py-4",children:[(0,u.jsx)("label",{className:"block mb-2",children:"Tanggal:"}),(0,u.jsx)("input",{type:"date",id:"eventDate",className:"input input-bordered w-full mb-4",required:!0}),(0,u.jsx)("label",{className:"block mb-2",children:"Tipe Event:"}),(0,u.jsxs)("select",{id:"eventType",className:"select select-bordered w-full mb-4",required:!0,children:[(0,u.jsx)("option",{value:"kunjungan",children:"Kunjungan PKL"}),(0,u.jsx)("option",{value:"keberangkatan",children:"Keberangkatan PKL"})]}),(0,u.jsx)("label",{className:"block mb-2",children:"Perusahaan:"}),(0,u.jsx)(p.Ay,{options:N,value:l,onChange:r,placeholder:"Select a company",className:"mb-4",required:!0})]}),(0,u.jsxs)("div",{className:"modal-action",children:[(0,u.jsx)("button",{onClick:async()=>{const e=document.getElementById("eventDate").value,t=document.getElementById("eventType").value;if(e&&t&&l){const s=document.getElementById("my_modal_1");s&&s.close();if((await g().fire({title:"Absen",text:"Apakah Anda yakin ingin menambahkan jadwal?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, absen!"})).isConfirmed){const s="kunjungan"===t?"ORANGE":"GREEN",r=o()(e).startOf("day"),i={status:t,date:r.format("YYYY-MM-DD"),user_id:j.id,industri_id:l.value};try{await v.A.post("/admin/jadwal",i,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"application/json"}});const e=r.format("YYYY-MM-DD"),n=r.endOf("day").format("YYYY-MM-DD");a((a=>[...a,{...i,start:e,end:n,title:`${t} ke ${l.label}`,theme:s}])),x.oR.success("New Event Added!")}catch(n){x.oR.error("Error adding event. Please try again.")}}else x.oR.error("Please fill in all required fields")}else x.oR.error("Please fill in all required fields")},type:"button",className:"pl-4 btn btn-success btn-sm hover:btn-primary",children:"Tambah"}),(0,u.jsx)("button",{onClick:()=>document.getElementById("my_modal_1").close(),type:"button",className:"ml-4 btn btn-sm btn-error hover:btn-primary",children:"Tutup"})]})]})}),(0,u.jsx)(x.N9,{})]})};const Y=function(){const e=(0,s.wA)();return(0,n.useEffect)((()=>{e((0,l.wE)({title:"Calendar"}))}),[]),(0,u.jsx)(w,{})}}}]);
//# sourceMappingURL=378.9816f0b0.chunk.js.map